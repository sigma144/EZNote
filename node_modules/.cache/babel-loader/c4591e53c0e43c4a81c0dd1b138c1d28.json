{"ast":null,"code":"import _classCallCheck from \"/root/eznote/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/root/eznote/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/root/eznote/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/root/eznote/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/root/eznote/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/root/eznote/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/root/eznote/src/App.js\";\nimport React, { Component } from 'react';\nimport './App.css';\nimport Button from './Button.js';\nimport Staff from './images/staff.png';\nimport Popup from './Popup.js';\nimport MIDISounds from 'midi-sounds-react';\n\nvar App =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(App, _Component);\n\n  function App() {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(App).call(this));\n\n    _this.setSelectedNote = function (selected) {\n      _this.setState({\n        note: selected\n      });\n    };\n\n    _this.setBPM = function (BPM) {\n      _this.setState({\n        bpm: BPM\n      });\n    };\n\n    _this.setBPMEvent = function (e) {\n      _this.setBPM(e.target.value);\n    };\n\n    _this.incBPM = function () {\n      _this.setBPM(_this.state.bpm + 5);\n\n      console.log(\"inc\");\n    };\n\n    _this.decBPM = function () {\n      _this.setBPM(_this.state.bpm - 5);\n    };\n\n    _this.startPlaying = function () {\n      _this.setMeasure(0);\n\n      _this.setState({\n        speedmod: 60000 / _this.state.bpm,\n        playcount: _this.state.playcount + 1\n      }, function () {\n        this.playNote(0, this.state.playcount);\n      });\n    };\n\n    _this.stopPlaying = function () {\n      _this.setMeasure(0);\n\n      _this.setState({\n        playing: undefined\n      });\n\n      console.log(\"stop pitch\");\n    };\n\n    _this.playNote = function (noteindex, playcount) {\n      if (playcount !== _this.state.playcount) return;\n\n      if (noteindex + _this.state.measure * 25 >= _this.state.allnotes.length) {\n        _this.stopPlaying();\n\n        return;\n      }\n\n      if (noteindex > 50) {\n        _this.setMeasure(_this.state.measure + 2);\n\n        _this.playNote(0, playcount);\n\n        return;\n      }\n\n      if (noteindex % 25 === 0 && _this.state.accoffset.length > 0) {\n        _this.setState({\n          accoffset: [],\n          lastacc: undefined\n        }, function () {\n          this.playNote(noteindex, playcount);\n        });\n\n        return;\n      }\n\n      var note = _this.state.notes[noteindex];\n\n      if (!note) {\n        _this.playNote(noteindex + 1, playcount);\n\n        return;\n      }\n\n      if (_this.isClef(note.note)) {\n        _this.setState({\n          clefoffset: _this.state.clefs[note.note]\n        }, function () {\n          this.playNote(noteindex + 1, playcount);\n        });\n\n        return;\n      }\n\n      if (_this.isAcc(note.note)) {\n        _this.setState({\n          lastacc: note.note\n        }, function () {\n          this.playNote(noteindex + 1, playcount);\n        });\n\n        return;\n      }\n\n      var duration = _this.state.noteduration[note.note];\n\n      if (!duration) {\n        _this.playNote(noteindex + 1, playcount);\n\n        return;\n      }\n\n      _this.setState({\n        playing: note\n      });\n\n      console.log(\"stop pitch\");\n\n      if (_this.state.notepitch[note.note] !== undefined) {\n        if (_this.state.lastacc) {\n          _this.state.accoffset[note.y] = _this.state.accidentals[_this.state.lastacc];\n\n          _this.setState({\n            lastacc: undefined\n          });\n        }\n\n        var acc = _this.state.accoffset[note.y];\n        var notey = 4 + note.y + _this.state.notepitch[note.note] + _this.state.clefoffset;\n        var pitch = _this.state.baseoffset - Math.round(notey * 12 / 7) + (acc ? acc : 0);\n\n        _this.midiSounds.playChordNow(3, [60], 2.5);\n\n        console.log(\"play note \" + note.note + pitch);\n      }\n\n      setTimeout(function () {\n        if (this.state.playing) this.playNote(noteindex + 1, playcount);\n      }.bind(_assertThisInitialized(_assertThisInitialized(_this))), duration * _this.state.speedmod);\n    };\n\n    _this.setClef = function (selected) {\n      _this.setState({\n        clef: selected,\n        clefpop: false,\n        note: selected\n      });\n    };\n\n    _this.setTime = function (selected) {\n      _this.setState({\n        time: selected,\n        timepop: false,\n        note: selected\n      });\n    };\n\n    _this.placeClef = function (selected) {\n      _this.setState({\n        clefpop: false\n      });\n\n      _this.state.notes[1] = {\n        note: selected,\n        x: 1,\n        y: 22\n      };\n\n      _this.forceUpdate();\n    };\n\n    _this.placeTime = function (selected) {\n      _this.setState({\n        timepop: false,\n        begin: false\n      });\n\n      _this.state.notes[3] = {\n        note: selected,\n        x: 3,\n        y: 22\n      };\n\n      _this.forceUpdate();\n    };\n\n    _this.clearIntro = function () {\n      _this.setState({\n        intropop: false\n      });\n    };\n\n    _this.getNoteX = function (note, x) {\n      if (x < 0) return -100;\n      return Math.round((x * 12 + 32) * window.innerWidth / 1000);\n    };\n\n    _this.getNoteY = function (note, y) {\n      return Math.round((y * 6.6 - (_this.isAcc(note) ? 44 : 47)) * window.innerWidth / 1000 + 100);\n    };\n\n    _this.state = {\n      mx: 0,\n      my: 0,\n      x: 0,\n      y: 0,\n      nx: -100,\n      ny: -100,\n      note: \"quarter\",\n      speed: \"100\",\n      allnotes: [],\n      measure: 0,\n      notes: [],\n      intropop: false,\n      clefpop: false,\n      timepop: false,\n      begin: false,\n      playing: undefined,\n      bpm: 100,\n      speedmod: 0,\n      playcount: 0,\n      clef: \"treble\",\n      time: \"44\",\n      baseoffset: 70,\n      clefoffset: 0,\n      accoffset: [],\n      lastacc: undefined,\n      notepitch: {\n        quarter: 0,\n        eighth: 0,\n        half: 0,\n        barnote: 0,\n        quarterdot: 0,\n        halfdot: 0,\n        whole: 3\n      },\n      noteduration: {\n        quarter: 1,\n        eighth: 0.5,\n        half: 2,\n        barnote: 0.5,\n        quarterdot: 1.5,\n        halfdot: 3,\n        whole: 4,\n        rquarter: 1,\n        reighth: 0.5,\n        rhalf: 2\n      },\n      clefs: {\n        treble: 0,\n        bass: -5,\n        treble8: -7\n      },\n      accidentals: {\n        flat: -1,\n        sharp: 1,\n        natural: 0\n      }\n    };\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"saveMeasures\",\n    value: function saveMeasures() {\n      for (var i = 0; i < 75; i++) {\n        if (this.state.notes[i] !== undefined) this.state.notes[i].x = i + this.state.measure * 25;\n        this.state.allnotes[i + this.state.measure * 25] = this.state.notes[i];\n      }\n    }\n  }, {\n    key: \"loadMeasures\",\n    value: function loadMeasures() {\n      for (var i = 0; i < 75; i++) {\n        this.state.notes[i] = this.state.allnotes[i + this.state.measure * 25];\n        if (this.state.notes[i] !== undefined) this.state.notes[i].x = i;\n      }\n    }\n  }, {\n    key: \"setMeasure\",\n    value: function setMeasure(val) {\n      this.saveMeasures();\n      this.state.measure = val;\n      this.loadMeasures();\n      this.forceUpdate();\n    }\n  }, {\n    key: \"incMeasure\",\n    value: function incMeasure() {\n      if (this.state.playing) this.stopPlaying();\n      this.setMeasure(this.state.measure + 1);\n    }\n  }, {\n    key: \"decMeasure\",\n    value: function decMeasure() {\n      if (this.state.playing) this.stopPlaying();\n      if (this.state.measure === 0) return;\n      this.setMeasure(this.state.measure - 1);\n    }\n  }, {\n    key: \"showClefPopup\",\n    value: function showClefPopup() {\n      this.setState(function (prevState, props) {\n        return {\n          clefpop: true\n        };\n      });\n    }\n  }, {\n    key: \"hideClefPopup\",\n    value: function hideClefPopup() {\n      this.setState(function (prevState, props) {\n        return {\n          clefpop: false\n        };\n      });\n    }\n  }, {\n    key: \"showTimePopup\",\n    value: function showTimePopup() {\n      this.setState(function (prevState, props) {\n        return {\n          timepop: true\n        };\n      });\n    }\n  }, {\n    key: \"hideTimePopup\",\n    value: function hideTimePopup() {\n      this.setState(function (prevState, props) {\n        return {\n          timepop: false\n        };\n      });\n    }\n  }, {\n    key: \"isAcc\",\n    value: function isAcc(note) {\n      return note === \"flat\" || note === \"sharp\" || note === \"natural\";\n    }\n  }, {\n    key: \"isClef\",\n    value: function isClef(note) {\n      return note === \"treble\" || note === \"bass\" || note === \"treble8\";\n    }\n  }, {\n    key: \"isTime\",\n    value: function isTime(note) {\n      return note.length === 2;\n    }\n  }, {\n    key: \"rerender\",\n    value: function rerender() {\n      this.forceUpdate();\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      window.addEventListener(\"resize\", this.rerender.bind(this));\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      window.removeEventListener(\"resize\", this.rerender.bind(this));\n    }\n  }, {\n    key: \"_onMouseMove\",\n    value: function _onMouseMove(e) {\n      this.setState({\n        mx: Math.round(e.pageX / window.innerWidth * 1000),\n        my: Math.round((e.pageY - 70) / window.innerWidth * 1000),\n        x: Math.round((this.state.mx - 50) / 12),\n        y: this.state.note[0] === \"r\" ? 23 : this.isTime(this.state.note) || this.isClef(this.state.note) ? 22 : this.isAcc(this.state.note) ? Math.round(this.state.my / 6.6) + 4 : this.state.note === \"whole\" ? Math.round(this.state.my / 6.6) + 5 : Math.round(this.state.my / 6.6),\n        nx: this.state.my < 20 || this.state.my > 220 || this.state.mx < 55 || this.state.mx > 940 ? -100 : this.getNoteX(this.state.note, this.state.x),\n        ny: this.state.my < 20 || this.state.my > 220 || this.state.mx < 55 || this.state.mx > 940 ? -100 : this.getNoteY(this.state.note, this.state.y)\n      });\n    }\n  }, {\n    key: \"_onMouseDown\",\n    value: function _onMouseDown(e) {\n      if (this.state.nx < 0 || this.state.ny < 0) return;\n      if (this.state.clefpop || this.state.timepop || this.state.intropop) return;\n      if (this.state.playing) this.stopPlaying();\n      var curNote = this.state.notes[this.state.x];\n\n      if (this.state.note === \"x\") {\n        this.state.notes[this.state.x] = undefined;\n      } else if (curNote === undefined || !(curNote.y === this.state.y && curNote.note === this.state.note)) {\n        this.state.notes[this.state.x] = {\n          note: this.state.note,\n          x: this.state.x,\n          y: this.state.y\n        };\n      } else {\n        this.state.notes[this.state.x] = undefined;\n      }\n\n      this.forceUpdate();\n    }\n  }, {\n    key: \"getMarkerPosition\",\n    value: function getMarkerPosition() {\n      return {\n        left: this.state.playing ? this.getNoteX(this.state.playing, this.state.playing.x) + Math.round(5 * window.innerWidth / 1000) + \"px\" : \"-101px\",\n        top: this.state.playing ? this.getNoteY(this.state.playing, this.state.playing.y) + Math.round(35 * window.innerWidth / 1000) + \"px\" : \"-101px\"\n      };\n    }\n  }, {\n    key: \"renderNotes\",\n    value: function renderNotes() {\n      var notes = [];\n      var barnote = undefined;\n\n      for (var i = 0; i < this.state.notes.length; i++) {\n        var note = this.state.notes[i];\n        if (note === undefined) continue;\n        notes.push(React.createElement(\"img\", {\n          className: \"note\",\n          src: require(\"./images/\" + note.note + \".png\"),\n          alt: \"\",\n          style: {\n            left: this.getNoteX(note.note, note.x) + \"px\",\n            top: this.getNoteY(note.note, note.y) + \"px\"\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 253\n          },\n          __self: this\n        }));\n\n        if (note.note === \"barnote\") {\n          if (barnote === undefined) barnote = note;else {\n            var bx1 = this.getNoteX(barnote.note, barnote.x) + Math.round(26 * window.innerWidth / 1000);\n            var bx2 = this.getNoteX(note.note, note.x) + Math.round(26 * window.innerWidth / 1000);\n            var by1 = this.getNoteY(barnote.note, barnote.y) + Math.round(5 * window.innerWidth / 1000);\n            var by2 = this.getNoteY(note.note, note.y) + Math.round(5 * window.innerWidth / 1000);\n            var minx = Math.min(bx1, bx2);\n            var miny = Math.min(by1, by2) - Math.round(10 * window.innerWidth / 1000);\n            var dx = Math.abs(bx2 - bx1);\n            var dy = Math.abs(by2 - by1) + Math.round(20 * window.innerWidth / 1000);\n            notes.push(React.createElement(\"svg\", {\n              width: dx,\n              height: dy,\n              style: {\n                left: minx,\n                top: miny\n              },\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 272\n              },\n              __self: this\n            }, React.createElement(\"line\", {\n              x1: bx1 - minx,\n              y1: by1 - miny,\n              x2: bx2 - minx,\n              y2: by2 - miny,\n              stroke: \"black\",\n              strokeWidth: \"0.5vw\",\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 273\n              },\n              __self: this\n            })));\n            barnote = undefined;\n          }\n        } else barnote = undefined;\n      }\n\n      return notes;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return React.createElement(\"div\", {\n        className: \"App\",\n        onMouseMove: this._onMouseMove.bind(this),\n        onMouseDown: this._onMouseDown.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 284\n        },\n        __self: this\n      }, React.createElement(MIDISounds, {\n        id: \"midi\",\n        ref: function ref(_ref) {\n          return _this2.midiSounds = _ref;\n        },\n        appElementName: \"root\",\n        instruments: [3],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 286\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        id: \"body\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 287\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        className: \"mnumber\",\n        style: {\n          left: \"5vw\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 288\n        },\n        __self: this\n      }, this.state.measure + 1), React.createElement(\"p\", {\n        className: \"mnumber\",\n        style: {\n          left: \"35vw\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 290\n        },\n        __self: this\n      }, this.state.measure + 2), React.createElement(\"p\", {\n        className: \"mnumber\",\n        style: {\n          left: \"65vw\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 292\n        },\n        __self: this\n      }, this.state.measure + 3), React.createElement(\"p\", {\n        className: \"mnumber\",\n        style: {\n          left: \"95vw\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 294\n        },\n        __self: this\n      }, this.state.measure + 4), React.createElement(\"img\", {\n        id: \"staff\",\n        src: Staff,\n        alt: \"\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 296\n        },\n        __self: this\n      }), React.createElement(\"button\", {\n        id: \"leftbutton\",\n        className: \"scrollButton\",\n        type: \"button\",\n        onClick: this.decMeasure.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 297\n        },\n        __self: this\n      }, \"\\u25C4\"), React.createElement(\"button\", {\n        id: \"rightbutton\",\n        className: \"scrollButton\",\n        type: \"button\",\n        onClick: this.incMeasure.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 299\n        },\n        __self: this\n      }, \"\\u25BA\"), React.createElement(\"img\", {\n        id: \"indicator\",\n        src: require(\"./images/\" + this.state.note + \".png\"),\n        alt: \"\",\n        style: {\n          left: this.state.nx + \"px\",\n          top: this.state.ny + \"px\",\n          visibility: this.state.note === \"x\" || this.state.clefpop || this.state.timepop || this.state.intropop ? \"hidden\" : \"visible\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 301\n        },\n        __self: this\n      }), React.createElement(\"p\", {\n        id: \"marker\",\n        style: this.getMarkerPosition(),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 307\n        },\n        __self: this\n      }, \"\\u25B2\"), this.renderNotes(), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 309\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        id: \"playback\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 310\n        },\n        __self: this\n      }, this.state.playing === undefined ? React.createElement(\"button\", {\n        className: \"playbutton\",\n        type: \"button\",\n        onClick: this.startPlaying.bind(this),\n        style: {\n          backgroundColor: \"forestgreen\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 312\n        },\n        __self: this\n      }, \"Play \\u25BA\") : React.createElement(\"button\", {\n        className: \"playbutton\",\n        type: \"button\",\n        onClick: this.stopPlaying.bind(this),\n        style: {\n          backgroundColor: \"red\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 315\n        },\n        __self: this\n      }, \"Stop \", React.createElement(\"span\", {\n        id: \"stop\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 317\n        },\n        __self: this\n      }, \"\\u25A0\")), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 318\n        },\n        __self: this\n      }, React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 319\n        },\n        __self: this\n      }), React.createElement(\"p\", {\n        style: {\n          fontSize: \"2vw\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 320\n        },\n        __self: this\n      }, \"Speed (bpm):\"), React.createElement(\"input\", {\n        id: \"speedinput\",\n        type: \"text\",\n        name: \"speed\",\n        defaultValue: this.state.bpm,\n        onChange: this.setBPMEvent,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 321\n        },\n        __self: this\n      }), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 323\n        },\n        __self: this\n      }))), React.createElement(\"div\", {\n        id: \"notes\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 326\n        },\n        __self: this\n      }, React.createElement(Button, {\n        image: \"quarter\",\n        selected: this.state.note,\n        callback: this.setSelectedNote,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 327\n        },\n        __self: this\n      }), React.createElement(Button, {\n        image: \"eighth\",\n        selected: this.state.note,\n        callback: this.setSelectedNote,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 329\n        },\n        __self: this\n      }), React.createElement(Button, {\n        image: \"half\",\n        selected: this.state.note,\n        callback: this.setSelectedNote,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 331\n        },\n        __self: this\n      }), React.createElement(Button, {\n        image: \"eighthbar\",\n        selected: this.state.note,\n        callback: this.setSelectedNote,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 333\n        },\n        __self: this\n      }), React.createElement(Button, {\n        image: \"quarterdot\",\n        selected: this.state.note,\n        callback: this.setSelectedNote,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 335\n        },\n        __self: this\n      }), React.createElement(Button, {\n        image: \"halfdot\",\n        selected: this.state.note,\n        callback: this.setSelectedNote,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 337\n        },\n        __self: this\n      }), React.createElement(Button, {\n        image: \"whole\",\n        selected: this.state.note,\n        callback: this.setSelectedNote,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 339\n        },\n        __self: this\n      }), React.createElement(Button, {\n        image: \"rquarter\",\n        selected: this.state.note,\n        callback: this.setSelectedNote,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 342\n        },\n        __self: this\n      }), React.createElement(Button, {\n        image: \"reighth\",\n        selected: this.state.note,\n        callback: this.setSelectedNote,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 344\n        },\n        __self: this\n      }), React.createElement(Button, {\n        image: \"rhalf\",\n        selected: this.state.note,\n        callback: this.setSelectedNote,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 346\n        },\n        __self: this\n      }), React.createElement(Button, {\n        image: \"flat\",\n        selected: this.state.note,\n        callback: this.setSelectedNote,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 348\n        },\n        __self: this\n      }), React.createElement(Button, {\n        image: \"sharp\",\n        selected: this.state.note,\n        callback: this.setSelectedNote,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 350\n        },\n        __self: this\n      }), React.createElement(Button, {\n        image: \"natural\",\n        selected: this.state.note,\n        callback: this.setSelectedNote,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 352\n        },\n        __self: this\n      }), React.createElement(Button, {\n        image: \"x\",\n        selected: this.state.note,\n        callback: this.setSelectedNote,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 354\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        id: \"select\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 357\n        },\n        __self: this\n      }, React.createElement(Button, {\n        image: this.state.clef,\n        selected: this.state.note,\n        callback: this.setSelectedNote,\n        size: \"8\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 358\n        },\n        __self: this\n      }), React.createElement(Button, {\n        image: this.state.time,\n        selected: this.state.note,\n        callback: this.setSelectedNote,\n        size: \"8\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 360\n        },\n        __self: this\n      }), React.createElement(\"button\", {\n        className: \"cbutton\",\n        type: \"button\",\n        onClick: this.showClefPopup.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 362\n        },\n        __self: this\n      }, \"Change\"), React.createElement(\"button\", {\n        className: \"cbutton\",\n        type: \"button\",\n        onClick: this.showTimePopup.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 364\n        },\n        __self: this\n      }, \"Change\"), this.state.timepop ? React.createElement(Popup, {\n        type: \"time\",\n        begin: this.state.begin,\n        callback: this.state.begin ? this.placeTime : this.setTime,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 366\n        },\n        __self: this\n      }) : null, this.state.clefpop ? React.createElement(Popup, {\n        type: \"clef\",\n        begin: this.state.begin,\n        callback: this.state.begin ? this.placeClef : this.setClef,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 368\n        },\n        __self: this\n      }) : null, this.state.intropop ? React.createElement(Popup, {\n        type: \"intro\",\n        callback: this.clearIntro,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 370\n        },\n        __self: this\n      }) : null))));\n    }\n  }]);\n\n  return App;\n}(Component);\n\nexport default App;","map":{"version":3,"sources":["/root/eznote/src/App.js"],"names":["React","Component","Button","Staff","Popup","MIDISounds","App","setSelectedNote","selected","setState","note","setBPM","BPM","bpm","setBPMEvent","e","target","value","incBPM","state","console","log","decBPM","startPlaying","setMeasure","speedmod","playcount","playNote","stopPlaying","playing","undefined","noteindex","measure","allnotes","length","accoffset","lastacc","notes","isClef","clefoffset","clefs","isAcc","duration","noteduration","notepitch","y","accidentals","acc","notey","pitch","baseoffset","Math","round","midiSounds","playChordNow","setTimeout","bind","setClef","clef","clefpop","setTime","time","timepop","placeClef","x","forceUpdate","placeTime","begin","clearIntro","intropop","getNoteX","window","innerWidth","getNoteY","mx","my","nx","ny","speed","quarter","eighth","half","barnote","quarterdot","halfdot","whole","rquarter","reighth","rhalf","treble","bass","treble8","flat","sharp","natural","i","val","saveMeasures","loadMeasures","prevState","props","addEventListener","rerender","removeEventListener","pageX","pageY","isTime","curNote","left","top","push","require","bx1","bx2","by1","by2","minx","min","miny","dx","abs","dy","_onMouseMove","_onMouseDown","ref","decMeasure","incMeasure","visibility","getMarkerPosition","renderNotes","backgroundColor","fontSize","showClefPopup","showTimePopup"],"mappings":";;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAO,WAAP;AACA,OAAOC,MAAP,MAAmB,aAAnB;AACA,OAAOC,KAAP,MAAkB,oBAAlB;AACA,OAAOC,KAAP,MAAkB,YAAlB;AACA,OAAOC,UAAP,MAAuB,mBAAvB;;IAEMC,G;;;;;AACJ,iBAAc;AAAA;;AAAA;;AACZ;;AADY,UAgCdC,eAhCc,GAgCI,UAACC,QAAD,EAAc;AAC9B,YAAKC,QAAL,CAAc;AAACC,QAAAA,IAAI,EAAEF;AAAP,OAAd;AACD,KAlCa;;AAAA,UAmCdG,MAnCc,GAmCL,UAACC,GAAD,EAAS;AAChB,YAAKH,QAAL,CAAc;AAACI,QAAAA,GAAG,EAAED;AAAN,OAAd;AACD,KArCa;;AAAA,UAsCdE,WAtCc,GAsCA,UAACC,CAAD,EAAO;AACnB,YAAKJ,MAAL,CAAYI,CAAC,CAACC,MAAF,CAASC,KAArB;AACD,KAxCa;;AAAA,UAyCdC,MAzCc,GAyCL,YAAM;AAAE,YAAKP,MAAL,CAAY,MAAKQ,KAAL,CAAWN,GAAX,GAAiB,CAA7B;;AAAiCO,MAAAA,OAAO,CAACC,GAAR,CAAY,KAAZ;AAAoB,KAzCxD;;AAAA,UA0CdC,MA1Cc,GA0CL,YAAM;AAAE,YAAKX,MAAL,CAAY,MAAKQ,KAAL,CAAWN,GAAX,GAAiB,CAA7B;AAAiC,KA1CpC;;AAAA,UA2CdU,YA3Cc,GA2CC,YAAM;AACnB,YAAKC,UAAL,CAAgB,CAAhB;;AACA,YAAKf,QAAL,CAAc;AAACgB,QAAAA,QAAQ,EAAE,QAAQ,MAAKN,KAAL,CAAWN,GAA9B;AAAmCa,QAAAA,SAAS,EAAE,MAAKP,KAAL,CAAWO,SAAX,GAAuB;AAArE,OAAd,EACH,YAAY;AAAC,aAAKC,QAAL,CAAc,CAAd,EAAiB,KAAKR,KAAL,CAAWO,SAA5B;AAAuC,OADjD;AAED,KA/Ca;;AAAA,UAgDdE,WAhDc,GAgDA,YAAM;AAClB,YAAKJ,UAAL,CAAgB,CAAhB;;AACA,YAAKf,QAAL,CAAc;AAACoB,QAAAA,OAAO,EAAEC;AAAV,OAAd;;AACAV,MAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ;AACD,KApDa;;AAAA,UAqDdM,QArDc,GAqDH,UAACI,SAAD,EAAYL,SAAZ,EAA0B;AACnC,UAAIA,SAAS,KAAK,MAAKP,KAAL,CAAWO,SAA7B,EAAwC;;AACxC,UAAIK,SAAS,GAAG,MAAKZ,KAAL,CAAWa,OAAX,GAAmB,EAA/B,IAAqC,MAAKb,KAAL,CAAWc,QAAX,CAAoBC,MAA7D,EAAqE;AACnE,cAAKN,WAAL;;AACA;AACD;;AACD,UAAIG,SAAS,GAAG,EAAhB,EAAoB;AAClB,cAAKP,UAAL,CAAgB,MAAKL,KAAL,CAAWa,OAAX,GAAmB,CAAnC;;AACA,cAAKL,QAAL,CAAc,CAAd,EAAiBD,SAAjB;;AACA;AACD;;AACD,UAAKK,SAAD,GAAc,EAAd,KAAqB,CAArB,IAA0B,MAAKZ,KAAL,CAAWgB,SAAX,CAAqBD,MAArB,GAA8B,CAA5D,EAA+D;AAC7D,cAAKzB,QAAL,CAAc;AAAC0B,UAAAA,SAAS,EAAE,EAAZ;AAAgBC,UAAAA,OAAO,EAAEN;AAAzB,SAAd,EAAmD,YAAW;AAC5D,eAAKH,QAAL,CAAcI,SAAd,EAAyBL,SAAzB;AAAoC,SADtC;;AAEA;AACD;;AACD,UAAIhB,IAAI,GAAG,MAAKS,KAAL,CAAWkB,KAAX,CAAiBN,SAAjB,CAAX;;AACA,UAAI,CAACrB,IAAL,EAAW;AACT,cAAKiB,QAAL,CAAcI,SAAS,GAAC,CAAxB,EAA2BL,SAA3B;;AACA;AACD;;AACD,UAAI,MAAKY,MAAL,CAAY5B,IAAI,CAACA,IAAjB,CAAJ,EAA4B;AAC1B,cAAKD,QAAL,CAAc;AAAC8B,UAAAA,UAAU,EAAE,MAAKpB,KAAL,CAAWqB,KAAX,CAAiB9B,IAAI,CAACA,IAAtB;AAAb,SAAd,EAAyD,YAAY;AAC1E,eAAKiB,QAAL,CAAcI,SAAS,GAAC,CAAxB,EAA2BL,SAA3B;AAAsC,SADjC;;AAEA;AACD;;AACD,UAAI,MAAKe,KAAL,CAAW/B,IAAI,CAACA,IAAhB,CAAJ,EAA2B;AACzB,cAAKD,QAAL,CAAc;AAAC2B,UAAAA,OAAO,EAAE1B,IAAI,CAACA;AAAf,SAAd,EAAoC,YAAY;AAC9C,eAAKiB,QAAL,CAAcI,SAAS,GAAC,CAAxB,EAA2BL,SAA3B;AAAsC,SADxC;;AAEA;AACD;;AACD,UAAIgB,QAAQ,GAAG,MAAKvB,KAAL,CAAWwB,YAAX,CAAwBjC,IAAI,CAACA,IAA7B,CAAf;;AACA,UAAI,CAACgC,QAAL,EAAe;AACb,cAAKf,QAAL,CAAcI,SAAS,GAAC,CAAxB,EAA2BL,SAA3B;;AACA;AACD;;AACD,YAAKjB,QAAL,CAAc;AAACoB,QAAAA,OAAO,EAAEnB;AAAV,OAAd;;AACAU,MAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ;;AACA,UAAI,MAAKF,KAAL,CAAWyB,SAAX,CAAqBlC,IAAI,CAACA,IAA1B,MAAoCoB,SAAxC,EAAmD;AACjD,YAAI,MAAKX,KAAL,CAAWiB,OAAf,EAAwB;AAC7B,gBAAKjB,KAAL,CAAWgB,SAAX,CAAqBzB,IAAI,CAACmC,CAA1B,IAA+B,MAAK1B,KAAL,CAAW2B,WAAX,CAAuB,MAAK3B,KAAL,CAAWiB,OAAlC,CAA/B;;AACA,gBAAK3B,QAAL,CAAc;AAAC2B,YAAAA,OAAO,EAAEN;AAAV,WAAd;AACM;;AACD,YAAIiB,GAAG,GAAG,MAAK5B,KAAL,CAAWgB,SAAX,CAAqBzB,IAAI,CAACmC,CAA1B,CAAV;AACA,YAAIG,KAAK,GAAG,IAAItC,IAAI,CAACmC,CAAT,GAAa,MAAK1B,KAAL,CAAWyB,SAAX,CAAqBlC,IAAI,CAACA,IAA1B,CAAb,GAA+C,MAAKS,KAAL,CAAWoB,UAAtE;AACA,YAAIU,KAAK,GAAG,MAAK9B,KAAL,CAAW+B,UAAX,GAAwBC,IAAI,CAACC,KAAL,CAAWJ,KAAK,GAAG,EAAR,GAAa,CAAxB,CAAxB,IAAsDD,GAAG,GAAGA,GAAH,GAAS,CAAlE,CAAZ;;AACA,cAAKM,UAAL,CAAgBC,YAAhB,CAA6B,CAA7B,EAAgC,CAAC,EAAD,CAAhC,EAAsC,GAAtC;;AACAlC,QAAAA,OAAO,CAACC,GAAR,CAAY,eAAeX,IAAI,CAACA,IAApB,GAA2BuC,KAAvC;AACD;;AACDM,MAAAA,UAAU,CAAC,YAAW;AACzB,YAAI,KAAKpC,KAAL,CAAWU,OAAf,EAAwB,KAAKF,QAAL,CAAcI,SAAS,GAAC,CAAxB,EAA2BL,SAA3B;AACpB,OAFU,CAET8B,IAFS,uDAAD,EAEId,QAAQ,GAAG,MAAKvB,KAAL,CAAWM,QAF1B,CAAV;AAGD,KAzGa;;AAAA,UA0GdgC,OA1Gc,GA0GJ,UAACjD,QAAD,EAAc;AACtB,YAAKC,QAAL,CAAc;AAACiD,QAAAA,IAAI,EAAElD,QAAP;AAAiBmD,QAAAA,OAAO,EAAE,KAA1B;AAAiCjD,QAAAA,IAAI,EAAEF;AAAvC,OAAd;AACD,KA5Ga;;AAAA,UA6GdoD,OA7Gc,GA6GJ,UAACpD,QAAD,EAAc;AACtB,YAAKC,QAAL,CAAc;AAACoD,QAAAA,IAAI,EAAErD,QAAP;AAAiBsD,QAAAA,OAAO,EAAE,KAA1B;AAAiCpD,QAAAA,IAAI,EAAEF;AAAvC,OAAd;AACD,KA/Ga;;AAAA,UAgHduD,SAhHc,GAgHF,UAACvD,QAAD,EAAc;AACxB,YAAKC,QAAL,CAAc;AAACkD,QAAAA,OAAO,EAAE;AAAV,OAAd;;AACA,YAAKxC,KAAL,CAAWkB,KAAX,CAAiB,CAAjB,IAAsB;AAAC3B,QAAAA,IAAI,EAACF,QAAN;AAAewD,QAAAA,CAAC,EAAC,CAAjB;AAAmBnB,QAAAA,CAAC,EAAC;AAArB,OAAtB;;AACA,YAAKoB,WAAL;AACD,KApHa;;AAAA,UAqHdC,SArHc,GAqHF,UAAC1D,QAAD,EAAc;AACxB,YAAKC,QAAL,CAAc;AAACqD,QAAAA,OAAO,EAAE,KAAV;AAAiBK,QAAAA,KAAK,EAAE;AAAxB,OAAd;;AACA,YAAKhD,KAAL,CAAWkB,KAAX,CAAiB,CAAjB,IAAsB;AAAC3B,QAAAA,IAAI,EAACF,QAAN;AAAewD,QAAAA,CAAC,EAAC,CAAjB;AAAmBnB,QAAAA,CAAC,EAAC;AAArB,OAAtB;;AACA,YAAKoB,WAAL;AACD,KAzHa;;AAAA,UA0HdG,UA1Hc,GA0HD,YAAM;AACjB,YAAK3D,QAAL,CAAc;AAAC4D,QAAAA,QAAQ,EAAE;AAAX,OAAd;AACD,KA5Ha;;AAAA,UA+KdC,QA/Kc,GA+KH,UAAC5D,IAAD,EAAOsD,CAAP,EAAa;AACtB,UAAIA,CAAC,GAAG,CAAR,EAAW,OAAO,CAAC,GAAR;AACX,aAAOb,IAAI,CAACC,KAAL,CAAW,CAACY,CAAC,GAAG,EAAJ,GAAS,EAAV,IAAgBO,MAAM,CAACC,UAAvB,GAAoC,IAA/C,CAAP;AACD,KAlLa;;AAAA,UAmLdC,QAnLc,GAmLH,UAAC/D,IAAD,EAAOmC,CAAP,EAAa;AACtB,aAAOM,IAAI,CAACC,KAAL,CAAW,CAACP,CAAC,GAAG,GAAJ,IAAW,MAAKJ,KAAL,CAAW/B,IAAX,IAAmB,EAAnB,GAAwB,EAAnC,CAAD,IAA2C6D,MAAM,CAACC,UAAlD,GAA+D,IAA/D,GAAsE,GAAjF,CAAP;AACD,KArLa;;AAEZ,UAAKrD,KAAL,GAAa;AAACuD,MAAAA,EAAE,EAAE,CAAL;AAAQC,MAAAA,EAAE,EAAE,CAAZ;AAAeX,MAAAA,CAAC,EAAE,CAAlB;AAAqBnB,MAAAA,CAAC,EAAE,CAAxB;AAA2B+B,MAAAA,EAAE,EAAE,CAAC,GAAhC;AAAqCC,MAAAA,EAAE,EAAE,CAAC,GAA1C;AACbnE,MAAAA,IAAI,EAAE,SADO;AACIoE,MAAAA,KAAK,EAAE,KADX;AAEb7C,MAAAA,QAAQ,EAAE,EAFG;AAGbD,MAAAA,OAAO,EAAE,CAHI;AAIbK,MAAAA,KAAK,EAAE,EAJM;AAKbgC,MAAAA,QAAQ,EAAE,KALG;AAMbV,MAAAA,OAAO,EAAE,KANI;AAObG,MAAAA,OAAO,EAAE,KAPI;AAQbK,MAAAA,KAAK,EAAE,KARM;AASbtC,MAAAA,OAAO,EAAEC,SATI;AAUbjB,MAAAA,GAAG,EAAE,GAVQ;AAWbY,MAAAA,QAAQ,EAAE,CAXG;AAYbC,MAAAA,SAAS,EAAE,CAZE;AAabgC,MAAAA,IAAI,EAAE,QAbO;AAcbG,MAAAA,IAAI,EAAE,IAdO;AAebX,MAAAA,UAAU,EAAE,EAfC;AAgBbX,MAAAA,UAAU,EAAE,CAhBC;AAiBbJ,MAAAA,SAAS,EAAE,EAjBE;AAkBbC,MAAAA,OAAO,EAAEN,SAlBI;AAmBbc,MAAAA,SAAS,EACV;AAACmC,QAAAA,OAAO,EAAE,CAAV;AAAaC,QAAAA,MAAM,EAAE,CAArB;AAAwBC,QAAAA,IAAI,EAAE,CAA9B;AAAiCC,QAAAA,OAAO,EAAE,CAA1C;AACsBC,QAAAA,UAAU,EAAE,CADlC;AACqCC,QAAAA,OAAO,EAAE,CAD9C;AACiDC,QAAAA,KAAK,EAAE;AADxD,OApBc;AAsBb1C,MAAAA,YAAY,EACb;AAACoC,QAAAA,OAAO,EAAE,CAAV;AAAaC,QAAAA,MAAM,EAAE,GAArB;AAA0BC,QAAAA,IAAI,EAAE,CAAhC;AAAmCC,QAAAA,OAAO,EAAE,GAA5C;AACCC,QAAAA,UAAU,EAAE,GADb;AACkBC,QAAAA,OAAO,EAAE,CAD3B;AAC8BC,QAAAA,KAAK,EAAE,CADrC;AAECC,QAAAA,QAAQ,EAAE,CAFX;AAEcC,QAAAA,OAAO,EAAE,GAFvB;AAE4BC,QAAAA,KAAK,EAAE;AAFnC,OAvBc;AA0BbhD,MAAAA,KAAK,EAAE;AAACiD,QAAAA,MAAM,EAAE,CAAT;AAAYC,QAAAA,IAAI,EAAE,CAAC,CAAnB;AAAsBC,QAAAA,OAAO,EAAE,CAAC;AAAhC,OA1BM;AA2Bb7C,MAAAA,WAAW,EAAE;AAAC8C,QAAAA,IAAI,EAAE,CAAC,CAAR;AAAWC,QAAAA,KAAK,EAAE,CAAlB;AAAqBC,QAAAA,OAAO,EAAE;AAA9B;AA3BA,KAAb;AAFY;AA+Bb;;;;mCA8Fc;AACb,WAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,EAApB,EAAwBA,CAAC,EAAzB,EAA6B;AAC3B,YAAI,KAAK5E,KAAL,CAAWkB,KAAX,CAAiB0D,CAAjB,MAAwBjE,SAA5B,EACL,KAAKX,KAAL,CAAWkB,KAAX,CAAiB0D,CAAjB,EAAoB/B,CAApB,GAAwB+B,CAAC,GAAG,KAAK5E,KAAL,CAAWa,OAAX,GAAmB,EAA/C;AACK,aAAKb,KAAL,CAAWc,QAAX,CAAoB8D,CAAC,GAAG,KAAK5E,KAAL,CAAWa,OAAX,GAAmB,EAA3C,IAAiD,KAAKb,KAAL,CAAWkB,KAAX,CAAiB0D,CAAjB,CAAjD;AACD;AACF;;;mCACc;AACb,WAAK,IAAIA,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,EAApB,EAAwBA,CAAC,EAAzB,EAA6B;AAC3B,aAAK5E,KAAL,CAAWkB,KAAX,CAAiB0D,CAAjB,IAAsB,KAAK5E,KAAL,CAAWc,QAAX,CAAoB8D,CAAC,GAAG,KAAK5E,KAAL,CAAWa,OAAX,GAAmB,EAA3C,CAAtB;AACA,YAAI,KAAKb,KAAL,CAAWkB,KAAX,CAAiB0D,CAAjB,MAAwBjE,SAA5B,EACE,KAAKX,KAAL,CAAWkB,KAAX,CAAiB0D,CAAjB,EAAoB/B,CAApB,GAAwB+B,CAAxB;AACH;AACF;;;+BACUC,G,EAAK;AACd,WAAKC,YAAL;AACA,WAAK9E,KAAL,CAAWa,OAAX,GAAqBgE,GAArB;AACA,WAAKE,YAAL;AACA,WAAKjC,WAAL;AACD;;;iCACY;AACX,UAAI,KAAK9C,KAAL,CAAWU,OAAf,EAAwB,KAAKD,WAAL;AACxB,WAAKJ,UAAL,CAAgB,KAAKL,KAAL,CAAWa,OAAX,GAAqB,CAArC;AACD;;;iCACY;AACX,UAAI,KAAKb,KAAL,CAAWU,OAAf,EAAwB,KAAKD,WAAL;AACxB,UAAI,KAAKT,KAAL,CAAWa,OAAX,KAAuB,CAA3B,EAA8B;AAC9B,WAAKR,UAAL,CAAgB,KAAKL,KAAL,CAAWa,OAAX,GAAqB,CAArC;AACD;;;oCACe;AACd,WAAKvB,QAAL,CAAc,UAAC0F,SAAD,EAAYC,KAAZ,EAAsB;AAAC,eAAO;AAACzC,UAAAA,OAAO,EAAE;AAAV,SAAP;AAAuB,OAA5D;AACD;;;oCACe;AACd,WAAKlD,QAAL,CAAc,UAAC0F,SAAD,EAAYC,KAAZ,EAAsB;AAAC,eAAO;AAACzC,UAAAA,OAAO,EAAE;AAAV,SAAP;AAAwB,OAA7D;AACD;;;oCACe;AACd,WAAKlD,QAAL,CAAc,UAAC0F,SAAD,EAAYC,KAAZ,EAAsB;AAAC,eAAO;AAACtC,UAAAA,OAAO,EAAE;AAAV,SAAP;AAAuB,OAA5D;AACD;;;oCACe;AACd,WAAKrD,QAAL,CAAc,UAAC0F,SAAD,EAAYC,KAAZ,EAAsB;AAAC,eAAO;AAACtC,UAAAA,OAAO,EAAE;AAAV,SAAP;AAAwB,OAA7D;AACD;;;0BACKpD,I,EAAM;AACV,aAAOA,IAAI,KAAK,MAAT,IAAmBA,IAAI,KAAK,OAA5B,IAAuCA,IAAI,KAAK,SAAvD;AACD;;;2BACMA,I,EAAM;AACX,aAAOA,IAAI,KAAK,QAAT,IAAqBA,IAAI,KAAK,MAA9B,IAAwCA,IAAI,KAAK,SAAxD;AACD;;;2BACMA,I,EAAM;AACX,aAAOA,IAAI,CAACwB,MAAL,KAAgB,CAAvB;AACD;;;+BAQU;AACT,WAAK+B,WAAL;AACD;;;wCACmB;AAClBM,MAAAA,MAAM,CAAC8B,gBAAP,CAAwB,QAAxB,EAAkC,KAAKC,QAAL,CAAc9C,IAAd,CAAmB,IAAnB,CAAlC;AACD;;;2CACsB;AACrBe,MAAAA,MAAM,CAACgC,mBAAP,CAA2B,QAA3B,EAAqC,KAAKD,QAAL,CAAc9C,IAAd,CAAmB,IAAnB,CAArC;AACD;;;iCACYzC,C,EAAG;AACd,WAAKN,QAAL,CAAc;AAAEiE,QAAAA,EAAE,EAAEvB,IAAI,CAACC,KAAL,CAAWrC,CAAC,CAACyF,KAAF,GAAUjC,MAAM,CAACC,UAAjB,GAA8B,IAAzC,CAAN;AACZG,QAAAA,EAAE,EAAExB,IAAI,CAACC,KAAL,CAAW,CAACrC,CAAC,CAAC0F,KAAF,GAAU,EAAX,IAAiBlC,MAAM,CAACC,UAAxB,GAAqC,IAAhD,CADQ;AAEZR,QAAAA,CAAC,EAAEb,IAAI,CAACC,KAAL,CAAW,CAAC,KAAKjC,KAAL,CAAWuD,EAAX,GAAgB,EAAjB,IAAuB,EAAlC,CAFS;AAGZ7B,QAAAA,CAAC,EAAG,KAAK1B,KAAL,CAAWT,IAAX,CAAgB,CAAhB,MAAuB,GAAvB,GAA6B,EAA7B,GACP,KAAKgG,MAAL,CAAY,KAAKvF,KAAL,CAAWT,IAAvB,KACA,KAAK4B,MAAL,CAAY,KAAKnB,KAAL,CAAWT,IAAvB,CADA,GAC+B,EAD/B,GAEA,KAAK+B,KAAL,CAAW,KAAKtB,KAAL,CAAWT,IAAtB,IACAyC,IAAI,CAACC,KAAL,CAAW,KAAKjC,KAAL,CAAWwD,EAAX,GAAgB,GAA3B,IAAkC,CADlC,GAEA,KAAKxD,KAAL,CAAWT,IAAX,KAAoB,OAApB,GACqByC,IAAI,CAACC,KAAL,CAAW,KAAKjC,KAAL,CAAWwD,EAAX,GAAgB,GAA3B,IAAkC,CADvD,GAEAxB,IAAI,CAACC,KAAL,CAAW,KAAKjC,KAAL,CAAWwD,EAAX,GAAgB,GAA3B,CAVe;AAWZC,QAAAA,EAAE,EAAG,KAAKzD,KAAL,CAAWwD,EAAX,GAAgB,EAAhB,IAAsB,KAAKxD,KAAL,CAAWwD,EAAX,GAAgB,GAAtC,IACP,KAAKxD,KAAL,CAAWuD,EAAX,GAAgB,EADT,IACe,KAAKvD,KAAL,CAAWuD,EAAX,GAAgB,GADhC,GACuC,CAAC,GADxC,GAEP,KAAKJ,QAAL,CAAc,KAAKnD,KAAL,CAAWT,IAAzB,EAA+B,KAAKS,KAAL,CAAW6C,CAA1C,CAbe;AAcZa,QAAAA,EAAE,EAAG,KAAK1D,KAAL,CAAWwD,EAAX,GAAgB,EAAhB,IAAsB,KAAKxD,KAAL,CAAWwD,EAAX,GAAgB,GAAtC,IACP,KAAKxD,KAAL,CAAWuD,EAAX,GAAgB,EADT,IACe,KAAKvD,KAAL,CAAWuD,EAAX,GAAgB,GADhC,GACuC,CAAC,GADxC,GAEP,KAAKD,QAAL,CAAc,KAAKtD,KAAL,CAAWT,IAAzB,EAA+B,KAAKS,KAAL,CAAW0B,CAA1C;AAhBe,OAAd;AAkBD;;;iCACY9B,C,EAAG;AACd,UAAI,KAAKI,KAAL,CAAWyD,EAAX,GAAgB,CAAhB,IAAqB,KAAKzD,KAAL,CAAW0D,EAAX,GAAgB,CAAzC,EAA4C;AAC5C,UAAI,KAAK1D,KAAL,CAAWwC,OAAX,IAAsB,KAAKxC,KAAL,CAAW2C,OAAjC,IACP,KAAK3C,KAAL,CAAWkD,QADR,EACkB;AAClB,UAAI,KAAKlD,KAAL,CAAWU,OAAf,EAAwB,KAAKD,WAAL;AACxB,UAAI+E,OAAO,GAAG,KAAKxF,KAAL,CAAWkB,KAAX,CAAiB,KAAKlB,KAAL,CAAW6C,CAA5B,CAAd;;AACA,UAAI,KAAK7C,KAAL,CAAWT,IAAX,KAAoB,GAAxB,EAA6B;AAC3B,aAAKS,KAAL,CAAWkB,KAAX,CAAiB,KAAKlB,KAAL,CAAW6C,CAA5B,IAAiClC,SAAjC;AACD,OAFD,MAGK,IAAI6E,OAAO,KAAK7E,SAAZ,IAAyB,EAAE6E,OAAO,CAAC9D,CAAR,KAAc,KAAK1B,KAAL,CAAW0B,CAAzB,IACjC8D,OAAO,CAACjG,IAAR,KAAiB,KAAKS,KAAL,CAAWT,IADG,CAA7B,EACiC;AACpC,aAAKS,KAAL,CAAWkB,KAAX,CAAiB,KAAKlB,KAAL,CAAW6C,CAA5B,IACH;AAACtD,UAAAA,IAAI,EAAC,KAAKS,KAAL,CAAWT,IAAjB;AAAuBsD,UAAAA,CAAC,EAAC,KAAK7C,KAAL,CAAW6C,CAApC;AAAuCnB,UAAAA,CAAC,EAAC,KAAK1B,KAAL,CAAW0B;AAApD,SADG;AAED,OAJI,MAKA;AACH,aAAK1B,KAAL,CAAWkB,KAAX,CAAiB,KAAKlB,KAAL,CAAW6C,CAA5B,IAAiClC,SAAjC;AACD;;AACD,WAAKmC,WAAL;AACD;;;wCACmB;AAClB,aAAO;AACJ2C,QAAAA,IAAI,EAAE,KAAKzF,KAAL,CAAWU,OAAX,GAAqB,KAAKyC,QAAL,CAAc,KAAKnD,KAAL,CAAWU,OAAzB,EAAkC,KAAKV,KAAL,CAAWU,OAAX,CAAmBmC,CAArD,IACjCb,IAAI,CAACC,KAAL,CAAW,IAAImB,MAAM,CAACC,UAAX,GAAwB,IAAnC,CADiC,GACQ,IAD7B,GACoC,QAFtC;AAGVqC,QAAAA,GAAG,EAAE,KAAK1F,KAAL,CAAWU,OAAX,GAAqB,KAAK4C,QAAL,CAAc,KAAKtD,KAAL,CAAWU,OAAzB,EAAkC,KAAKV,KAAL,CAAWU,OAAX,CAAmBgB,CAArD,IAC1BM,IAAI,CAACC,KAAL,CAAW,KAAKmB,MAAM,CAACC,UAAZ,GAAyB,IAApC,CAD0B,GACgB,IADrC,GAC4C;AAJvC,OAAP;AAMD;;;kCACa;AACZ,UAAInC,KAAK,GAAG,EAAZ;AACA,UAAI6C,OAAO,GAAGpD,SAAd;;AACA,WAAK,IAAIiE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAK5E,KAAL,CAAWkB,KAAX,CAAiBH,MAArC,EAA6C6D,CAAC,EAA9C,EAAkD;AAChD,YAAIrF,IAAI,GAAG,KAAKS,KAAL,CAAWkB,KAAX,CAAiB0D,CAAjB,CAAX;AACA,YAAIrF,IAAI,KAAKoB,SAAb,EAAwB;AACxBO,QAAAA,KAAK,CAACyE,IAAN,CAAW;AAAK,UAAA,SAAS,EAAC,MAAf;AACL,UAAA,GAAG,EAAEC,OAAO,CAAC,cAAcrG,IAAI,CAACA,IAAnB,GAA0B,MAA3B,CADP;AAC2C,UAAA,GAAG,EAAC,EAD/C;AAEL,UAAA,KAAK,EAAE;AAACkG,YAAAA,IAAI,EAAE,KAAKtC,QAAL,CAAc5D,IAAI,CAACA,IAAnB,EAAyBA,IAAI,CAACsD,CAA9B,IAAmC,IAA1C;AACC6C,YAAAA,GAAG,EAAE,KAAKpC,QAAL,CAAc/D,IAAI,CAACA,IAAnB,EAAyBA,IAAI,CAACmC,CAA9B,IAAmC;AADzC,WAFF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAAX;;AAIA,YAAInC,IAAI,CAACA,IAAL,KAAc,SAAlB,EAA6B;AAC3B,cAAIwE,OAAO,KAAKpD,SAAhB,EAA2BoD,OAAO,GAAGxE,IAAV,CAA3B,KACK;AACV,gBAAIsG,GAAG,GAAG,KAAK1C,QAAL,CAAcY,OAAO,CAACxE,IAAtB,EAA4BwE,OAAO,CAAClB,CAApC,IACXb,IAAI,CAACC,KAAL,CAAW,KAAKmB,MAAM,CAACC,UAAZ,GAAyB,IAApC,CADC;AAEA,gBAAIyC,GAAG,GAAG,KAAK3C,QAAL,CAAc5D,IAAI,CAACA,IAAnB,EAAyBA,IAAI,CAACsD,CAA9B,IACXb,IAAI,CAACC,KAAL,CAAW,KAAKmB,MAAM,CAACC,UAAZ,GAAyB,IAApC,CADC;AAEA,gBAAI0C,GAAG,GAAG,KAAKzC,QAAL,CAAcS,OAAO,CAACxE,IAAtB,EAA4BwE,OAAO,CAACrC,CAApC,IACXM,IAAI,CAACC,KAAL,CAAW,IAAImB,MAAM,CAACC,UAAX,GAAwB,IAAnC,CADC;AAEO,gBAAI2C,GAAG,GAAG,KAAK1C,QAAL,CAAc/D,IAAI,CAACA,IAAnB,EAAyBA,IAAI,CAACmC,CAA9B,IAClBM,IAAI,CAACC,KAAL,CAAW,IAAImB,MAAM,CAACC,UAAX,GAAwB,IAAnC,CADQ;AAEP,gBAAI4C,IAAI,GAAGjE,IAAI,CAACkE,GAAL,CAASL,GAAT,EAAcC,GAAd,CAAX;AACA,gBAAIK,IAAI,GAAGnE,IAAI,CAACkE,GAAL,CAASH,GAAT,EAAcC,GAAd,IAAmBhE,IAAI,CAACC,KAAL,CAAW,KAAKmB,MAAM,CAACC,UAAZ,GAAyB,IAApC,CAA9B;AACA,gBAAI+C,EAAE,GAAGpE,IAAI,CAACqE,GAAL,CAASP,GAAG,GAAGD,GAAf,CAAT;AACA,gBAAIS,EAAE,GAAGtE,IAAI,CAACqE,GAAL,CAASL,GAAG,GAAGD,GAAf,IAAoB/D,IAAI,CAACC,KAAL,CAAW,KAAKmB,MAAM,CAACC,UAAZ,GAAyB,IAApC,CAA7B;AACAnC,YAAAA,KAAK,CAACyE,IAAN,CAAW;AAAK,cAAA,KAAK,EAAES,EAAZ;AAAgB,cAAA,MAAM,EAAEE,EAAxB;AAA4B,cAAA,KAAK,EAAE;AAACb,gBAAAA,IAAI,EAAEQ,IAAP;AAAaP,gBAAAA,GAAG,EAAES;AAAlB,eAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eACZ;AAAM,cAAA,EAAE,EAAEN,GAAG,GAACI,IAAd;AAAoB,cAAA,EAAE,EAAEF,GAAG,GAACI,IAA5B;AAAkC,cAAA,EAAE,EAAEL,GAAG,GAACG,IAA1C;AAAgD,cAAA,EAAE,EAAED,GAAG,GAACG,IAAxD;AACA,cAAA,MAAM,EAAC,OADP;AACe,cAAA,WAAW,EAAC,OAD3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADY,CAAX;AAGApC,YAAAA,OAAO,GAAGpD,SAAV;AACM;AACF,SApBD,MAqBKoD,OAAO,GAAGpD,SAAV;AACN;;AACD,aAAOO,KAAP;AACD;;;6BACQ;AAAA;;AACP,aACE;AAAK,QAAA,SAAS,EAAC,KAAf;AAAqB,QAAA,WAAW,EAAE,KAAKqF,YAAL,CAAkBlE,IAAlB,CAAuB,IAAvB,CAAlC;AACL,QAAA,WAAW,EAAE,KAAKmE,YAAL,CAAkBnE,IAAlB,CAAuB,IAAvB,CADR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAEL,oBAAC,UAAD;AAAY,QAAA,EAAE,EAAC,MAAf;AAAsB,QAAA,GAAG,EAAE,aAACoE,IAAD;AAAA,iBAAU,MAAI,CAACvE,UAAL,GAAkBuE,IAA5B;AAAA,SAA3B;AAA6D,QAAA,cAAc,EAAC,MAA5E;AAAmF,QAAA,WAAW,EAAE,CAAC,CAAD,CAAhG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFK,EAGL;AAAK,QAAA,EAAE,EAAC,MAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAG,QAAA,SAAS,EAAC,SAAb;AAAuB,QAAA,KAAK,EAAE;AAAChB,UAAAA,IAAI,EAAE;AAAP,SAA9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACG,KAAKzF,KAAL,CAAWa,OAAX,GAAmB,CADtB,CADF,EAGE;AAAG,QAAA,SAAS,EAAC,SAAb;AAAuB,QAAA,KAAK,EAAE;AAAC4E,UAAAA,IAAI,EAAE;AAAP,SAA9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACG,KAAKzF,KAAL,CAAWa,OAAX,GAAmB,CADtB,CAHF,EAKE;AAAG,QAAA,SAAS,EAAC,SAAb;AAAuB,QAAA,KAAK,EAAE;AAAC4E,UAAAA,IAAI,EAAE;AAAP,SAA9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACG,KAAKzF,KAAL,CAAWa,OAAX,GAAmB,CADtB,CALF,EAOE;AAAG,QAAA,SAAS,EAAC,SAAb;AAAuB,QAAA,KAAK,EAAE;AAAC4E,UAAAA,IAAI,EAAE;AAAP,SAA9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACU,KAAKzF,KAAL,CAAWa,OAAX,GAAmB,CAD7B,CAPF,EASE;AAAK,QAAA,EAAE,EAAC,OAAR;AAAgB,QAAA,GAAG,EAAE7B,KAArB;AAA4B,QAAA,GAAG,EAAC,EAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QATF,EAUE;AAAQ,QAAA,EAAE,EAAC,YAAX;AAAwB,QAAA,SAAS,EAAC,cAAlC;AAAiD,QAAA,IAAI,EAAC,QAAtD;AACE,QAAA,OAAO,EAAE,KAAK0H,UAAL,CAAgBrE,IAAhB,CAAqB,IAArB,CADX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAVF,EAYE;AAAQ,QAAA,EAAE,EAAC,aAAX;AAAyB,QAAA,SAAS,EAAC,cAAnC;AAAkD,QAAA,IAAI,EAAC,QAAvD;AACE,QAAA,OAAO,EAAE,KAAKsE,UAAL,CAAgBtE,IAAhB,CAAqB,IAArB,CADX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAZF,EAcE;AAAK,QAAA,EAAE,EAAC,WAAR;AACE,QAAA,GAAG,EAAEuD,OAAO,CAAC,cAAc,KAAK5F,KAAL,CAAWT,IAAzB,GAAgC,MAAjC,CADd;AACwD,QAAA,GAAG,EAAC,EAD5D;AAEE,QAAA,KAAK,EAAE;AAACkG,UAAAA,IAAI,EAAE,KAAKzF,KAAL,CAAWyD,EAAX,GAAgB,IAAvB;AAA6BiC,UAAAA,GAAG,EAAE,KAAK1F,KAAL,CAAW0D,EAAX,GAAgB,IAAlD;AACNkD,UAAAA,UAAU,EAAG,KAAK5G,KAAL,CAAWT,IAAX,KAAoB,GAApB,IAA2B,KAAKS,KAAL,CAAWwC,OAAtC,IAChB,KAAKxC,KAAL,CAAW2C,OADK,IACM,KAAK3C,KAAL,CAAWkD,QADjB,GAEd,QAFc,GAEH;AAHJ,SAFT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAdF,EAoBE;AAAG,QAAA,EAAE,EAAC,QAAN;AAAe,QAAA,KAAK,EAAE,KAAK2D,iBAAL,EAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBApBF,EAqBG,KAAKC,WAAL,EArBH,EAsBE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAK,QAAA,EAAE,EAAC,UAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACG,KAAK9G,KAAL,CAAWU,OAAX,KAAuBC,SAAvB,GACN;AAAQ,QAAA,SAAS,EAAC,YAAlB;AAA+B,QAAA,IAAI,EAAC,QAApC;AAA6C,QAAA,OAAO,EACpD,KAAKP,YAAL,CAAkBiC,IAAlB,CAAuB,IAAvB,CADA;AAC8B,QAAA,KAAK,EAAE;AAAC0E,UAAAA,eAAe,EAAC;AAAjB,SADrC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBADM,GAIN;AAAQ,QAAA,SAAS,EAAC,YAAlB;AAA+B,QAAA,IAAI,EAAC,QAApC;AAA6C,QAAA,OAAO,EACpD,KAAKtG,WAAL,CAAiB4B,IAAjB,CAAsB,IAAtB,CADA;AAC6B,QAAA,KAAK,EAAE;AAAC0E,UAAAA,eAAe,EAAC;AAAjB,SADpC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAEK;AAAM,QAAA,EAAE,EAAC,MAAT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAFL,CALG,EAQE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADK,EAEE;AAAG,QAAA,KAAK,EAAE;AAACC,UAAAA,QAAQ,EAAE;AAAX,SAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAFF,EAGE;AAAO,QAAA,EAAE,EAAC,YAAV;AAAuB,QAAA,IAAI,EAAC,MAA5B;AAAmC,QAAA,IAAI,EAAC,OAAxC;AACP,QAAA,YAAY,EAAE,KAAKhH,KAAL,CAAWN,GADlB;AACuB,QAAA,QAAQ,EAAG,KAAKC,WADvC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAHF,EAKL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QALK,CARF,CADF,EAiBE;AAAK,QAAA,EAAE,EAAC,OAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,MAAD;AAAQ,QAAA,KAAK,EAAC,SAAd;AAAwB,QAAA,QAAQ,EAAE,KAAKK,KAAL,CAAWT,IAA7C;AACL,QAAA,QAAQ,EAAE,KAAKH,eADV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,EAGS,oBAAC,MAAD;AAAQ,QAAA,KAAK,EAAC,QAAd;AAAuB,QAAA,QAAQ,EAAE,KAAKY,KAAL,CAAWT,IAA5C;AACZ,QAAA,QAAQ,EAAE,KAAKH,eADH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAHT,EAKS,oBAAC,MAAD;AAAQ,QAAA,KAAK,EAAC,MAAd;AAAqB,QAAA,QAAQ,EAAE,KAAKY,KAAL,CAAWT,IAA1C;AACZ,QAAA,QAAQ,EAAE,KAAKH,eADH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QALT,EAOE,oBAAC,MAAD;AAAQ,QAAA,KAAK,EAAC,WAAd;AAA0B,QAAA,QAAQ,EAAE,KAAKY,KAAL,CAAWT,IAA/C;AACS,QAAA,QAAQ,EAAE,KAAKH,eADxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAPF,EASE,oBAAC,MAAD;AAAQ,QAAA,KAAK,EAAC,YAAd;AAA2B,QAAA,QAAQ,EAAE,KAAKY,KAAL,CAAWT,IAAhD;AACS,QAAA,QAAQ,EAAE,KAAKH,eADxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QATF,EAWE,oBAAC,MAAD;AAAQ,QAAA,KAAK,EAAC,SAAd;AAAwB,QAAA,QAAQ,EAAE,KAAKY,KAAL,CAAWT,IAA7C;AACS,QAAA,QAAQ,EAAE,KAAKH,eADxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAXF,EAaE,oBAAC,MAAD;AAAQ,QAAA,KAAK,EAAC,OAAd;AAAsB,QAAA,QAAQ,EAAE,KAAKY,KAAL,CAAWT,IAA3C;AACS,QAAA,QAAQ,EAAE,KAAKH,eADxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAbF,EAgBE,oBAAC,MAAD;AAAQ,QAAA,KAAK,EAAC,UAAd;AAAyB,QAAA,QAAQ,EAAE,KAAKY,KAAL,CAAWT,IAA9C;AACS,QAAA,QAAQ,EAAE,KAAKH,eADxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAhBF,EAkBE,oBAAC,MAAD;AAAQ,QAAA,KAAK,EAAC,SAAd;AAAwB,QAAA,QAAQ,EAAE,KAAKY,KAAL,CAAWT,IAA7C;AACS,QAAA,QAAQ,EAAE,KAAKH,eADxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAlBF,EAoBS,oBAAC,MAAD;AAAQ,QAAA,KAAK,EAAC,OAAd;AAAsB,QAAA,QAAQ,EAAE,KAAKY,KAAL,CAAWT,IAA3C;AACE,QAAA,QAAQ,EAAE,KAAKH,eADjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QApBT,EAsBS,oBAAC,MAAD;AAAQ,QAAA,KAAK,EAAC,MAAd;AAAqB,QAAA,QAAQ,EAAE,KAAKY,KAAL,CAAWT,IAA1C;AACE,QAAA,QAAQ,EAAE,KAAKH,eADjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAtBT,EAwBS,oBAAC,MAAD;AAAQ,QAAA,KAAK,EAAC,OAAd;AAAsB,QAAA,QAAQ,EAAE,KAAKY,KAAL,CAAWT,IAA3C;AACE,QAAA,QAAQ,EAAE,KAAKH,eADjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAxBT,EA0BE,oBAAC,MAAD;AAAQ,QAAA,KAAK,EAAC,SAAd;AAAwB,QAAA,QAAQ,EAAE,KAAKY,KAAL,CAAWT,IAA7C;AACS,QAAA,QAAQ,EAAE,KAAKH,eADxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QA1BF,EA4BE,oBAAC,MAAD;AAAQ,QAAA,KAAK,EAAC,GAAd;AAAkB,QAAA,QAAQ,EAAE,KAAKY,KAAL,CAAWT,IAAvC;AACS,QAAA,QAAQ,EAAE,KAAKH,eADxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QA5BF,CAjBF,EAgDE;AAAK,QAAA,EAAE,EAAC,QAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACS,oBAAC,MAAD;AAAQ,QAAA,KAAK,EAAE,KAAKY,KAAL,CAAWuC,IAA1B;AAAgC,QAAA,QAAQ,EAAE,KAAKvC,KAAL,CAAWT,IAArD;AACE,QAAA,QAAQ,EAAE,KAAKH,eADjB;AACkC,QAAA,IAAI,EAAC,GADvC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADT,EAGS,oBAAC,MAAD;AAAQ,QAAA,KAAK,EAAE,KAAKY,KAAL,CAAW0C,IAA1B;AAAgC,QAAA,QAAQ,EAAE,KAAK1C,KAAL,CAAWT,IAArD;AACE,QAAA,QAAQ,EAAE,KAAKH,eADjB;AACkC,QAAA,IAAI,EAAC,GADvC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAHT,EAKE;AAAQ,QAAA,SAAS,EAAC,SAAlB;AAA4B,QAAA,IAAI,EAAC,QAAjC;AACL,QAAA,OAAO,EAAE,KAAK6H,aAAL,CAAmB5E,IAAnB,CAAwB,IAAxB,CADJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBALF,EAOE;AAAQ,QAAA,SAAS,EAAC,SAAlB;AAA4B,QAAA,IAAI,EAAC,QAAjC;AACL,QAAA,OAAO,EAAE,KAAK6E,aAAL,CAAmB7E,IAAnB,CAAwB,IAAxB,CADJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAPF,EASG,KAAKrC,KAAL,CAAW2C,OAAX,GAAqB,oBAAC,KAAD;AAAO,QAAA,IAAI,EAAC,MAAZ;AAAmB,QAAA,KAAK,EAAE,KAAK3C,KAAL,CAAWgD,KAArC;AACb,QAAA,QAAQ,EAAE,KAAKhD,KAAL,CAAWgD,KAAX,GAAmB,KAAKD,SAAxB,GAAoC,KAAKN,OADtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAArB,GACwE,IAV3E,EAWG,KAAKzC,KAAL,CAAWwC,OAAX,GAAqB,oBAAC,KAAD;AAAO,QAAA,IAAI,EAAC,MAAZ;AAAmB,QAAA,KAAK,EAAE,KAAKxC,KAAL,CAAWgD,KAArC;AAC3B,QAAA,QAAQ,EAAE,KAAKhD,KAAL,CAAWgD,KAAX,GAAmB,KAAKJ,SAAxB,GAAoC,KAAKN,OADxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAArB,GAC0D,IAZ7D,EAaG,KAAKtC,KAAL,CAAWkD,QAAX,GAAsB,oBAAC,KAAD;AAAO,QAAA,IAAI,EAAC,OAAZ;AACd,QAAA,QAAQ,EAAE,KAAKD,UADD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAAtB,GACuC,IAd1C,CAhDF,CAtBF,CAHK,CADF;AA8FD;;;;EAjXenE,S;;AAoXlB,eAAeK,GAAf","sourcesContent":["import React, { Component } from 'react'\nimport './App.css'\nimport Button from './Button.js'\nimport Staff from './images/staff.png'\nimport Popup from './Popup.js'\nimport MIDISounds from 'midi-sounds-react'\n\nclass App extends Component {\n  constructor() {\n    super();\n    this.state = {mx: 0, my: 0, x: 0, y: 0, nx: -100, ny: -100,\n\t\t  note: \"quarter\", speed: \"100\",\n\t\t  allnotes: [],\n\t\t  measure: 0,\n\t\t  notes: [],\n\t\t  intropop: false,\n\t\t  clefpop: false,\n\t\t  timepop: false,\n\t\t  begin: false,\n\t\t  playing: undefined,\n\t\t  bpm: 100,\n\t\t  speedmod: 0,\n\t\t  playcount: 0,\n\t\t  clef: \"treble\",\n\t\t  time: \"44\",\n\t\t  baseoffset: 70,\n\t\t  clefoffset: 0,\n\t\t  accoffset: [],\n\t\t  lastacc: undefined,\n\t\t  notepitch:\n\t\t\t{quarter: 0, eighth: 0, half: 0, barnote: 0,\n                         quarterdot: 0, halfdot: 0, whole: 3},\n\t\t  noteduration:\n\t\t\t{quarter: 1, eighth: 0.5, half: 2, barnote: 0.5,\n\t\t\t quarterdot: 1.5, halfdot: 3, whole: 4,\n\t\t\t rquarter: 1, reighth: 0.5, rhalf: 2},\n\t\t  clefs: {treble: 0, bass: -5, treble8: -7},\n\t\t  accidentals: {flat: -1, sharp: 1, natural: 0}\n\t}\n  }\n  setSelectedNote = (selected) => {\n    this.setState({note: selected})\n  }\n  setBPM = (BPM) => {\n    this.setState({bpm: BPM})\n  }\n  setBPMEvent = (e) => {\n    this.setBPM(e.target.value)\n  }\n  incBPM = () => { this.setBPM(this.state.bpm + 5); console.log(\"inc\") }\n  decBPM = () => { this.setBPM(this.state.bpm - 5) }\n  startPlaying = () => {\n    this.setMeasure(0);\n    this.setState({speedmod: 60000 / this.state.bpm, playcount: this.state.playcount + 1},\n\tfunction () {this.playNote(0, this.state.playcount)})\n  }\n  stopPlaying = () => {\n    this.setMeasure(0);\n    this.setState({playing: undefined})\n    console.log(\"stop pitch\")\n  }\n  playNote = (noteindex, playcount) => {\n    if (playcount !== this.state.playcount) return\n    if (noteindex + this.state.measure*25 >= this.state.allnotes.length) {\n      this.stopPlaying()\n      return\n    }\n    if (noteindex > 50) {\n      this.setMeasure(this.state.measure+2)\n      this.playNote(0, playcount)\n      return\n    }\n    if ((noteindex) % 25 === 0 && this.state.accoffset.length > 0) {\n      this.setState({accoffset: [], lastacc: undefined}, function() {\n        this.playNote(noteindex, playcount)})\n      return\n    }\n    let note = this.state.notes[noteindex]\n    if (!note) {\n      this.playNote(noteindex+1, playcount)\n      return\n    }\n    if (this.isClef(note.note)) {\n      this.setState({clefoffset: this.state.clefs[note.note]}, function () {\n\tthis.playNote(noteindex+1, playcount)})\n      return\n    }\n    if (this.isAcc(note.note)) {\n      this.setState({lastacc: note.note}, function () {\n        this.playNote(noteindex+1, playcount)})\n      return\n    }\n    let duration = this.state.noteduration[note.note]\n    if (!duration) {\n      this.playNote(noteindex+1, playcount)\n      return\n    }\n    this.setState({playing: note})\n    console.log(\"stop pitch\")\n    if (this.state.notepitch[note.note] !== undefined) {\n      if (this.state.lastacc) {\n\tthis.state.accoffset[note.y] = this.state.accidentals[this.state.lastacc]\n\tthis.setState({lastacc: undefined})\n      }\n      let acc = this.state.accoffset[note.y]\n      let notey = 4 + note.y + this.state.notepitch[note.note] + this.state.clefoffset\n      let pitch = this.state.baseoffset - Math.round(notey * 12 / 7) + (acc ? acc : 0)\n      this.midiSounds.playChordNow(3, [60], 2.5)\n      console.log(\"play note \" + note.note + pitch)\n    }\n    setTimeout(function() {\n\tif (this.state.playing) this.playNote(noteindex+1, playcount)\n    }.bind(this), duration * this.state.speedmod)\n  }\n  setClef = (selected) => {\n    this.setState({clef: selected, clefpop: false, note: selected})\n  }\n  setTime = (selected) => {\n    this.setState({time: selected, timepop: false, note: selected})\n  }\n  placeClef = (selected) => {\n    this.setState({clefpop: false})\n    this.state.notes[1] = {note:selected,x:1,y:22}\n    this.forceUpdate()\n  }\n  placeTime = (selected) => {\n    this.setState({timepop: false, begin: false})\n    this.state.notes[3] = {note:selected,x:3,y:22}\n    this.forceUpdate()\n  }\n  clearIntro = () => {\n    this.setState({intropop: false})\n  }\n  saveMeasures() {\n    for (let i = 0; i < 75; i++) {\n      if (this.state.notes[i] !== undefined)\n\tthis.state.notes[i].x = i + this.state.measure*25;\n      this.state.allnotes[i + this.state.measure*25] = this.state.notes[i]\n    }\n  }\n  loadMeasures() {\n    for (let i = 0; i < 75; i++) {\n      this.state.notes[i] = this.state.allnotes[i + this.state.measure*25]\n      if (this.state.notes[i] !== undefined)\n        this.state.notes[i].x = i;\n    }\n  }\n  setMeasure(val) {\n    this.saveMeasures()\n    this.state.measure = val\n    this.loadMeasures()\n    this.forceUpdate()\n  }\n  incMeasure() {\n    if (this.state.playing) this.stopPlaying()\n    this.setMeasure(this.state.measure + 1)\n  }\n  decMeasure() {\n    if (this.state.playing) this.stopPlaying()\n    if (this.state.measure === 0) return\n    this.setMeasure(this.state.measure - 1)\n  }\n  showClefPopup() {\n    this.setState((prevState, props) => {return {clefpop: true}})\n  }\n  hideClefPopup() {\n    this.setState((prevState, props) => {return {clefpop: false}})\n  }\n  showTimePopup() {\n    this.setState((prevState, props) => {return {timepop: true}})\n  }\n  hideTimePopup() {\n    this.setState((prevState, props) => {return {timepop: false}})\n  }\n  isAcc(note) {\n    return note === \"flat\" || note === \"sharp\" || note === \"natural\"\n  }\n  isClef(note) {\n    return note === \"treble\" || note === \"bass\" || note === \"treble8\"\n  }\n  isTime(note) {\n    return note.length === 2\n  }\n  getNoteX = (note, x) => {\n    if (x < 0) return -100\n    return Math.round((x * 12 + 32) * window.innerWidth / 1000)\n  }\n  getNoteY = (note, y) => {\n    return Math.round((y * 6.6 - (this.isAcc(note) ? 44 : 47)) * window.innerWidth / 1000 + 100)\n  }\n  rerender() {\n    this.forceUpdate()\n  }\n  componentDidMount() {\n    window.addEventListener(\"resize\", this.rerender.bind(this));\n  }\n  componentWillUnmount() {\n    window.removeEventListener(\"resize\", this.rerender.bind(this));\n  }\n  _onMouseMove(e) {\n    this.setState({ mx: Math.round(e.pageX / window.innerWidth * 1000),\n\t\t    my: Math.round((e.pageY - 70) / window.innerWidth * 1000),\n\t\t    x: Math.round((this.state.mx - 50) / 12),\n\t\t    y: (this.state.note[0] === \"r\" ? 23 :\n\t\t\tthis.isTime(this.state.note) ||\n\t\t\tthis.isClef(this.state.note) ? 22 :\n\t\t\tthis.isAcc(this.state.note) ?\n\t\t\tMath.round(this.state.my / 6.6) + 4 :\n\t\t\tthis.state.note === \"whole\" ?\n                        Math.round(this.state.my / 6.6) + 5 :\n\t\t\tMath.round(this.state.my / 6.6)),\n\t\t    nx: (this.state.my < 20 || this.state.my > 220 ||\n\t\t\t this.state.mx < 55 || this.state.mx > 940) ? -100 :\n\t\t\tthis.getNoteX(this.state.note, this.state.x),\n\t\t    ny: (this.state.my < 20 || this.state.my > 220 ||\n\t\t\t this.state.mx < 55 || this.state.mx > 940) ? -100 :\n\t\t\tthis.getNoteY(this.state.note, this.state.y)\n\t\t})\n  }\n  _onMouseDown(e) {\n    if (this.state.nx < 0 || this.state.ny < 0) return\n    if (this.state.clefpop || this.state.timepop ||\n\tthis.state.intropop) return\n    if (this.state.playing) this.stopPlaying()\n    let curNote = this.state.notes[this.state.x]\n    if (this.state.note === \"x\") {\n      this.state.notes[this.state.x] = undefined\n    }\n    else if (curNote === undefined || !(curNote.y === this.state.y &&\n\t\t\t\t   curNote.note === this.state.note)) {\n      this.state.notes[this.state.x] =\n\t  {note:this.state.note, x:this.state.x, y:this.state.y}\n    }\n    else {\n      this.state.notes[this.state.x] = undefined\n    }\n    this.forceUpdate()\n  }\n  getMarkerPosition() {\n    return {\n       left: this.state.playing ? this.getNoteX(this.state.playing, this.state.playing.x)+\n\tMath.round(5 * window.innerWidth / 1000)+\"px\" : \"-101px\",\n\ttop: this.state.playing ? this.getNoteY(this.state.playing, this.state.playing.y)+\n\tMath.round(35 * window.innerWidth / 1000)+\"px\" : \"-101px\"\n    }\n  }\n  renderNotes() {\n    let notes = []\n    let barnote = undefined\n    for (let i = 0; i < this.state.notes.length; i++) {\n      let note = this.state.notes[i]\n      if (note === undefined) continue\n      notes.push(<img className=\"note\"\n            src={require(\"./images/\" + note.note + \".png\")} alt=\"\"\n            style={{left: this.getNoteX(note.note, note.x) + \"px\",\n                    top: this.getNoteY(note.note, note.y) + \"px\"}}/>)\n      if (note.note === \"barnote\") {\n        if (barnote === undefined) barnote = note\n        else {\n\t  let bx1 = this.getNoteX(barnote.note, barnote.x) +\n\t\tMath.round(26 * window.innerWidth / 1000)\n\t  let bx2 = this.getNoteX(note.note, note.x) +\n\t\tMath.round(26 * window.innerWidth / 1000)\n\t  let by1 = this.getNoteY(barnote.note, barnote.y) +\n\t\tMath.round(5 * window.innerWidth / 1000)\n          let by2 = this.getNoteY(note.note, note.y) +\n\t\tMath.round(5 * window.innerWidth / 1000);\n\t  let minx = Math.min(bx1, bx2)\n\t  let miny = Math.min(by1, by2)-Math.round(10 * window.innerWidth / 1000)\n\t  let dx = Math.abs(bx2 - bx1)\n\t  let dy = Math.abs(by2 - by1)+Math.round(20 * window.innerWidth / 1000)\n\t  notes.push(<svg width={dx} height={dy} style={{left: minx, top: miny}}>\n\t\t<line x1={bx1-minx} y1={by1-miny} x2={bx2-minx} y2={by2-miny}\n\t\tstroke=\"black\" strokeWidth=\"0.5vw\"/></svg>)\n\t  barnote = undefined\n        }\n      }\n      else barnote = undefined\n    }\n    return notes\n  }\n  render() {\n    return (\n      <div className=\"App\" onMouseMove={this._onMouseMove.bind(this)}\n\tonMouseDown={this._onMouseDown.bind(this)}>\n\t<MIDISounds id=\"midi\" ref={(ref) => (this.midiSounds = ref)} appElementName=\"root\" instruments={[3]} />\n\t<div id=\"body\">\n\t  <p className=\"mnumber\" style={{left: \"5vw\"}}>\n\t    {this.state.measure+1}</p>\n\t  <p className=\"mnumber\" style={{left: \"35vw\"}}>\n\t    {this.state.measure+2}</p>\n\t  <p className=\"mnumber\" style={{left: \"65vw\"}}>\n\t    {this.state.measure+3}</p>\n\t  <p className=\"mnumber\" style={{left: \"95vw\"}}>\n            {this.state.measure+4}</p>\n\t  <img id=\"staff\" src={Staff} alt=\"\" />\n\t  <button id=\"leftbutton\" className=\"scrollButton\" type=\"button\"\n\t    onClick={this.decMeasure.bind(this)}>&#x25c4;</button>\n\t  <button id=\"rightbutton\" className=\"scrollButton\" type=\"button\"\n\t    onClick={this.incMeasure.bind(this)}>&#x25ba;</button>\n\t  <img id=\"indicator\"\n\t    src={require(\"./images/\" + this.state.note + \".png\")} alt=\"\"\n\t    style={{left: this.state.nx + \"px\", top: this.state.ny + \"px\",\n\t\t    visibility: (this.state.note === \"x\" || this.state.clefpop ||\n\t\t\tthis.state.timepop || this.state.intropop\n\t\t\t? \"hidden\" : \"visible\")}}/>\n\t  <p id=\"marker\" style={this.getMarkerPosition()}>&#x25b2;</p>\n\t  {this.renderNotes()}\n\t  <div>\n\t    <div id=\"playback\">\n\t      {this.state.playing === undefined ?\n\t\t<button className=\"playbutton\" type=\"button\" onClick={\n\t\tthis.startPlaying.bind(this)} style={{backgroundColor:\"forestgreen\"}}>\n\t\tPlay &#x25ba;</button> :\n\t\t<button className=\"playbutton\" type=\"button\" onClick={\n\t\tthis.stopPlaying.bind(this)} style={{backgroundColor:\"red\"}}>\n\t\tStop <span id=\"stop\">&#x25a0;</span></button>}\n\t      <div>\n\t\t<br/>\n\t        <p style={{fontSize: \"2vw\"}}>Speed (bpm):</p>\n\t        <input id=\"speedinput\" type=\"text\" name=\"speed\"\n\t\tdefaultValue={this.state.bpm} onChange={ this.setBPMEvent }/>\n\t\t<br/>\n\t      </div>\n\t    </div>\n\t    <div id=\"notes\">\n\t      <Button image=\"quarter\" selected={this.state.note}\n\t\tcallback={this.setSelectedNote}/>\n              <Button image=\"eighth\" selected={this.state.note}\n\t\tcallback={this.setSelectedNote}/>\n              <Button image=\"half\" selected={this.state.note}\n\t\tcallback={this.setSelectedNote}/>\n\t      <Button image=\"eighthbar\" selected={this.state.note}\n                callback={this.setSelectedNote}/>\n\t      <Button image=\"quarterdot\" selected={this.state.note}\n                callback={this.setSelectedNote}/>\n\t      <Button image=\"halfdot\" selected={this.state.note}\n                callback={this.setSelectedNote}/>\n\t      <Button image=\"whole\" selected={this.state.note}\n                callback={this.setSelectedNote}/>\n\n\t      <Button image=\"rquarter\" selected={this.state.note}\n                callback={this.setSelectedNote}/>\n\t      <Button image=\"reighth\" selected={this.state.note}\n                callback={this.setSelectedNote}/>\n              <Button image=\"rhalf\" selected={this.state.note}\n                callback={this.setSelectedNote}/>\n              <Button image=\"flat\" selected={this.state.note}\n                callback={this.setSelectedNote}/>\n              <Button image=\"sharp\" selected={this.state.note}\n                callback={this.setSelectedNote}/>\n\t      <Button image=\"natural\" selected={this.state.note}\n                callback={this.setSelectedNote}/>\n\t      <Button image=\"x\" selected={this.state.note}\n                callback={this.setSelectedNote}/>\n\t    </div>\n\t    <div id=\"select\">\n              <Button image={this.state.clef} selected={this.state.note}\n                callback={this.setSelectedNote} size=\"8\"></Button>\n              <Button image={this.state.time} selected={this.state.note}\n                callback={this.setSelectedNote} size=\"8\"></Button>\n\t      <button className=\"cbutton\" type=\"button\"\n\t\tonClick={this.showClefPopup.bind(this)}>Change</button>\n\t      <button className=\"cbutton\" type=\"button\"\n\t\tonClick={this.showTimePopup.bind(this)}>Change</button>\n\t      {this.state.timepop ? <Popup type=\"time\" begin={this.state.begin}\n                callback={this.state.begin ? this.placeTime : this.setTime}/> : null}\n\t      {this.state.clefpop ? <Popup type=\"clef\" begin={this.state.begin}\n\t\tcallback={this.state.begin ? this.placeClef : this.setClef}/> : null}\n\t      {this.state.intropop ? <Popup type=\"intro\"\n                callback={this.clearIntro}/> : null}\n            </div>\n\t  </div>\n\t</div>\n      </div>\n    );\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}